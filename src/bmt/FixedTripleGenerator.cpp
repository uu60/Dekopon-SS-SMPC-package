//
// Created by 杜建璋 on 2024/8/30.
//

#include "bmt/FixedTripleGenerator.h"
#include "utils/Mpi.h"
#include "utils/Math.h"

template<typename T>
FixedTripleGenerator<T>::FixedTripleGenerator() = default;

template<typename T>
FixedTripleGenerator<T> *FixedTripleGenerator<T>::execute(bool dummy) {
    int idx = 0;
    if (Mpi::rank() == 0) {
        idx = Math::rand32(0, 99);
        Mpi::ssend(&idx);
    } else {
        Mpi::srecv(&idx);
    }
    std::tuple<std::pair<T, T>, std::pair<T, T>, std::pair<T, T>> triple = getRandomTriple(
            idx);
    if (Mpi::rank() == 0) {
        this->_ai = std::get<0>(triple).first;
        this->_bi = std::get<1>(triple).first;
        this->_ci = std::get<2>(triple).first;
    } else {
        this->_ai = std::get<0>(triple).second;
        this->_bi = std::get<1>(triple).second;
        this->_ci = std::get<2>(triple).second;
    }
    return this;
}

template<typename T>
std::string FixedTripleGenerator<T>::tag() const {
    return "[Fixed BMT Generator]";
}

template<typename T>
std::tuple<std::pair<T, T>, std::pair<T, T>, std::pair<T, T>>
FixedTripleGenerator<T>::getRandomTriple(int idx) {
    const std::array<std::tuple<std::pair<T, T>, std::pair<T, T>, std::pair<T, T>>, 100> *triple;
    if constexpr (std::is_same_v<T, bool>) {
        triple = &TRIPLES_1;
    } else if constexpr (std::is_same_v<T, int8_t>) {
        triple = &TRIPLES_8;
    } else if constexpr (std::is_same_v<T, int16_t>) {
        triple = &TRIPLES_16;
    } else if constexpr (std::is_same_v<T, int32_t>) {
        triple = &TRIPLES_32;
    } else {
        triple = &TRIPLES_64;
    }
    return (*triple)[idx];
}

template<typename T>
const std::array<std::tuple<std::pair<bool, bool>, std::pair<bool, bool>, std::pair<bool,
        bool>>, 100> FixedTripleGenerator<T>::TRIPLES_1 = {
        {{{0, 0}, {0, 1}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}}, {{0, 0}, {0, 1}, {0, 0}},
         {{0, 0}, {0, 1}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{1, 0}, {0, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}},
         {{0, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}},
         {{1, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{0, 1}, {0, 1}, {1, 0}}, {{0, 0}, {1, 0}, {0, 0}},
         {{1, 0}, {1, 0}, {0, 1}}, {{0, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 1}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}},
         {{0, 1}, {0, 0}, {0, 0}}, {{1, 0}, {1, 0}, {1, 0}}, {{0, 1}, {0, 1}, {1, 0}}, {{0, 0}, {0, 1}, {0, 0}},
         {{0, 1}, {1, 0}, {1, 0}}, {{0, 1}, {0, 1}, {1, 0}}, {{1, 0}, {0, 0}, {0, 0}}, {{1, 0}, {0, 1}, {0, 1}},
         {{0, 0}, {0, 1}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}}, {{0, 0}, {0, 1}, {0, 0}},
         {{1, 0}, {0, 0}, {0, 0}}, {{1, 0}, {0, 1}, {1, 0}}, {{0, 1}, {1, 0}, {1, 0}}, {{0, 0}, {0, 0}, {0, 0}},
         {{0, 0}, {1, 0}, {0, 0}}, {{0, 0}, {0, 1}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}}, {{1, 0}, {0, 0}, {0, 0}},
         {{1, 0}, {1, 0}, {0, 1}}, {{1, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}},
         {{0, 0}, {0, 1}, {0, 0}}, {{0, 1}, {0, 1}, {1, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{1, 0}, {1, 0}, {0, 1}},
         {{0, 0}, {1, 0}, {0, 0}}, {{0, 1}, {1, 0}, {0, 1}}, {{0, 1}, {0, 1}, {1, 0}}, {{0, 1}, {0, 0}, {0, 0}},
         {{0, 1}, {0, 1}, {0, 1}}, {{0, 0}, {1, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}},
         {{0, 0}, {1, 0}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}},
         {{1, 0}, {1, 0}, {1, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{1, 0}, {0, 0}, {0, 0}}, {{0, 1}, {0, 0}, {0, 0}},
         {{0, 1}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}}, {{0, 0}, {0, 1}, {0, 0}},
         {{1, 0}, {0, 1}, {0, 1}}, {{0, 1}, {0, 0}, {0, 0}}, {{0, 1}, {0, 1}, {0, 1}}, {{0, 1}, {1, 0}, {1, 0}},
         {{0, 1}, {0, 0}, {0, 0}}, {{1, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{1, 0}, {0, 0}, {0, 0}},
         {{0, 1}, {1, 0}, {1, 0}}, {{1, 0}, {1, 0}, {0, 1}}, {{1, 0}, {0, 1}, {1, 0}}, {{1, 0}, {1, 0}, {0, 1}},
         {{0, 1}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{1, 0}, {1, 0}, {0, 1}}, {{0, 1}, {0, 1}, {1, 0}},
         {{0, 0}, {0, 1}, {0, 0}}, {{0, 0}, {0, 1}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{1, 0}, {1, 0}, {1, 0}},
         {{1, 0}, {0, 0}, {0, 0}}, {{0, 1}, {1, 0}, {1, 0}}, {{1, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}},
         {{0, 1}, {0, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}}, {{1, 0}, {0, 1}, {1, 0}}, {{0, 1}, {0, 0}, {0, 0}},
         {{0, 0}, {0, 0}, {0, 0}}, {{0, 0}, {0, 0}, {0, 0}}, {{0, 0}, {1, 0}, {0, 0}}, {{0, 0}, {0, 1}, {0, 0}}}};

template<typename T>
const std::array<std::tuple<std::pair<int8_t, int8_t>, std::pair<int8_t, int8_t>, std::pair<int8_t, int8_t>>, 100> FixedTripleGenerator<T>::TRIPLES_8 = {
        {{{10, 49}, {88, 24}, {21, 59}}, {{4, 13}, {108, 10}, {83, 3}}, {{55, 14}, {41, 24}, {4, 1}},
         {{103, 2}, {58, 17}, {19, 48}}, {{7, 67}, {7, 2}, {26, 0}}, {{6, 43}, {76, 20}, {36, 60}},
         {{12, 13}, {40, 15}, {36, 59}}, {{7, 1}, {30, 5}, {7, 17}}, {{29, 29}, {26, 63}, {38, 4}},
         {{2, 9}, {113, 14}, {62, 55}}, {{4, 66}, {51, 27}, {69, 15}}, {{19, 18}, {20, 34}, {51, 27}},
         {{92, 17}, {99, 1}, {4, 16}}, {{63, 6}, {8, 43}, {31, 32}}, {{55, 63}, {34, 31}, {102, 16}},
         {{23, 27}, {2, 55}, {2, 32}}, {{38, 70}, {1, 3}, {15, 33}}, {{2, 27}, {16, 6}, {49, 77}},
         {{8, 3}, {26, 75}, {13, 74}}, {{41, 23}, {15, 49}, {0, 0}}, {{35, 21}, {1, 85}, {21, 59}},
         {{0, 4}, {6, 12}, {13, 59}}, {{84, 33}, {3, 25}, {36, 40}}, {{20, 58}, {96, 21}, {36, 2}},
         {{37, 66}, {24, 21}, {10, 17}}, {{1, 0}, {37, 46}, {49, 34}}, {{25, 38}, {44, 42}, {0, 42}},
         {{82, 16}, {9, 58}, {2, 36}}, {{73, 14}, {39, 41}, {39, 9}}, {{0, 1}, {39, 39}, {20, 58}},
         {{3, 35}, {93, 29}, {7, 21}}, {{4, 1}, {69, 49}, {52, 26}}, {{23, 10}, {32, 39}, {23, 16}},
         {{18, 16}, {27, 10}, {19, 87}}, {{42, 61}, {34, 22}, {2, 6}}, {{44, 48}, {25, 100}, {102, 6}},
         {{24, 82}, {8, 10}, {100, 16}}, {{17, 55}, {43, 72}, {36, 52}}, {{15, 14}, {21, 72}, {5, 4}},
         {{43, 20}, {25, 20}, {16, 3}}, {{30, 26}, {80, 19}, {21, 19}}, {{34, 21}, {15, 41}, {3, 5}},
         {{13, 43}, {48, 40}, {17, 47}}, {{41, 0}, {46, 32}, {84, 42}}, {{10, 56}, {22, 4}, {42, 10}},
         {{15, 52}, {0, 3}, {44, 29}}, {{45, 23}, {7, 35}, {15, 25}}, {{18, 28}, {4, 2}, {18, 2}},
         {{3, 6}, {49, 22}, {111, 16}}, {{1, 0}, {42, 20}, {27, 35}}, {{34, 15}, {6, 113}, {5, 66}},
         {{44, 8}, {52, 64}, {6, 10}}, {{20, 36}, {27, 62}, {117, 3}}, {{1, 1}, {32, 60}, {17, 39}},
         {{17, 11}, {24, 15}, {0, 68}}, {{6, 2}, {39, 52}, {27, 61}}, {{36, 0}, {32, 42}, {91, 13}},
         {{46, 31}, {16, 7}, {54, 53}}, {{3, 10}, {8, 69}, {64, 41}}, {{43, 11}, {4, 18}, {16, 20}},
         {{26, 38}, {21, 62}, {9, 55}}, {{20, 43}, {33, 36}, {102, 21}}, {{2, 51}, {52, 37}, {59, 50}},
         {{10, 14}, {1, 39}, {35, 29}}, {{14, 27}, {20, 1}, {15, 78}}, {{17, 60}, {5, 30}, {3, 4}},
         {{12, 4}, {74, 18}, {51, 13}}, {{0, 0}, {13, 31}, {0, 0}}, {{1, 0}, {39, 44}, {32, 51}},
         {{20, 33}, {0, 69}, {19, 54}}, {{56, 54}, {32, 48}, {2, 94}}, {{20, 38}, {12, 29}, {62, 12}},
         {{34, 34}, {57, 38}, {3, 57}}, {{34, 28}, {43, 18}, {14, 56}}, {{84, 21}, {33, 54}, {33, 14}},
         {{40, 52}, {9, 19}, {7, 9}}, {{20, 9}, {8, 5}, {99, 22}}, {{15, 26}, {41, 75}, {9, 11}},
         {{70, 5}, {9, 19}, {25, 27}}, {{4, 9}, {19, 17}, {77, 7}}, {{6, 14}, {115, 3}, {8, 48}},
         {{35, 5}, {6, 0}, {51, 61}}, {{1, 48}, {6, 101}, {96, 27}}, {{47, 41}, {2, 0}, {18, 30}},
         {{34, 14}, {106, 0}, {2, 94}}, {{2, 106}, {23, 17}, {27, 69}}, {{15, 0}, {61, 36}, {39, 8}},
         {{2, 4}, {55, 45}, {75, 13}}, {{63, 26}, {55, 11}, {65, 49}}, {{90, 4}, {53, 15}, {99, 21}},
         {{92, 9}, {56, 62}, {10, 4}}, {{27, 5}, {19, 6}, {5, 27}}, {{8, 18}, {34, 30}, {0, 0}},
         {{15, 1}, {67, 18}, {48, 32}}, {{43, 78}, {8, 38}, {14, 48}}, {{19, 6}, {69, 24}, {10, 11}},
         {{1, 8}, {32, 7}, {1, 94}}, {{8, 104}, {93, 21}, {12, 84}}, {{13, 0}, {22, 4}, {8, 74}},
         {{57, 64}, {43, 58}, {1, 60}}}};

template<typename T>
const std::array<std::tuple<std::pair<int16_t, int16_t>, std::pair<int16_t, int16_t>, std::pair<int16_t, int16_t>>, 100> FixedTripleGenerator<T>::TRIPLES_16 = {
        {{{1426, 26202}, {18257, 4810}, {8176, 14836}}, {{11821, 13637}, {17772, 10318}, {7636, 11520}},
         {{206, 8907}, {16652, 3861}, {13003, 13294}}, {{15550, 5464}, {27224, 4044}, {901, 915}},
         {{12000, 4051}, {3120, 10895}, {1821, 624}}, {{4482, 4297}, {15487, 2078}, {6593, 23102}},
         {{3039, 51}, {1944, 2382}, {15020, 15744}}, {{19223, 8493}, {12807, 4061}, {4673, 7759}},
         {{11020, 4043}, {12871, 3649}, {470, 98}}, {{13465, 18441}, {18605, 901}, {23337, 5243}},
         {{15504, 3983}, {353, 6131}, {14, 286}}, {{7158, 12114}, {12962, 844}, {14861, 10979}},
         {{2123, 3475}, {1891, 9076}, {1788, 17014}}, {{5954, 10322}, {18436, 5081}, {5587, 26865}},
         {{9262, 12652}, {15588, 15373}, {6995, 10919}}, {{21713, 1353}, {20685, 1065}, {6899, 521}},
         {{2186, 843}, {4029, 3427}, {5732, 1340}}, {{350, 24325}, {1091, 10237}, {6342, 1018}},
         {{2822, 1677}, {4963, 1176}, {5600, 23105}}, {{1724, 7598}, {1240, 2632}, {11666, 5550}},
         {{2569, 3245}, {3944, 1304}, {363, 4501}}, {{13685, 1503}, {8146, 15095}, {6025, 1387}},
         {{8735, 16157}, {11852, 3308}, {4408, 2024}}, {{1511, 11014}, {994, 1090}, {3377, 15395}},
         {{1654, 5445}, {26766, 3427}, {1467, 3152}}, {{1510, 1450}, {4288, 15522}, {3657, 11991}},
         {{820, 3095}, {2934, 570}, {13264, 7872}}, {{3121, 8605}, {5447, 11578}, {5584, 6910}},
         {{7185, 11485}, {6142, 1912}, {7350, 21246}}, {{20029, 3175}, {12782, 13689}, {1147, 28545}},
         {{30511, 667}, {3458, 1351}, {8018, 13384}}, {{3036, 5906}, {8298, 2021}, {11036, 19542}},
         {{4762, 13733}, {1496, 247}, {14705, 11136}}, {{9905, 8741}, {1719, 12763}, {1766, 21286}},
         {{14555, 3807}, {145, 11130}, {504, 2822}}, {{2771, 5260}, {554, 2401}, {7124, 449}},
         {{3689, 14521}, {3827, 10027}, {397, 111}}, {{121, 13807}, {799, 2985}, {10781, 1827}},
         {{4891, 0}, {4908, 225}, {4638, 577}}, {{11989, 9298}, {14515, 15135}, {3361, 11741}},
         {{19614, 9913}, {1209, 12183}, {3466, 10662}}, {{3721, 12615}, {674, 1494}, {1989, 25019}},
         {{7177, 2699}, {16277, 5544}, {17392, 4436}}, {{1033, 4062}, {3495, 13461}, {3426, 10946}},
         {{981, 11615}, {400, 17517}, {9275, 41}}, {{1171, 3526}, {8819, 3065}, {2398, 12846}},
         {{1323, 4428}, {25167, 5606}, {4883, 23440}}, {{24117, 904}, {6931, 4394}, {14270, 3659}},
         {{6915, 5200}, {299, 4999}, {20026, 5500}}, {{6829, 11149}, {1674, 19802}, {15215, 7737}},
         {{777, 14308}, {10934, 1666}, {12941, 3659}}, {{4175, 3809}, {16126, 605}, {5709, 12227}},
         {{238, 115}, {9662, 5971}, {11336, 2089}}, {{12215, 7454}, {2244, 11303}, {3757, 15578}},
         {{2811, 3544}, {5274, 91}, {5991, 9864}}, {{14550, 3139}, {4272, 7654}, {17458, 13940}},
         {{8984, 3514}, {24031, 7832}, {16032, 11006}}, {{4533, 16008}, {11045, 18121}, {367, 1095}},
         {{15206, 5816}, {17824, 12024}, {14593, 8399}}, {{9461, 17681}, {10, 794}, {18685, 12763}},
         {{1151, 1359}, {16484, 8778}, {1006, 534}}, {{4976, 957}, {2836, 14442}, {7617, 4453}},
         {{25428, 135}, {11622, 3279}, {4511, 14520}}, {{4388, 430}, {2673, 9464}, {431, 17523}},
         {{13283, 5275}, {1783, 2822}, {445, 201}}, {{8627, 5374}, {8, 327}, {181, 4330}},
         {{12722, 16352}, {15297, 8087}, {14968, 13752}}, {{22370, 10235}, {3703, 13908}, {2065, 10926}},
         {{129, 331}, {1690, 665}, {87, 1869}}, {{1833, 21694}, {5337, 198}, {1365, 548}},
         {{8063, 10426}, {951, 10116}, {9608, 4763}}, {{345, 1861}, {8625, 5544}, {14854, 14056}},
         {{6947, 2966}, {1656, 12609}, {1584, 13441}}, {{1987, 7319}, {1895, 30378}, {1302, 12516}},
         {{429, 1103}, {17198, 11032}, {3574, 23794}}, {{13603, 2456}, {3330, 17557}, {1139, 9946}},
         {{303, 14971}, {9464, 16241}, {16918, 7844}}, {{4175, 17668}, {5358, 8240}, {5485, 6477}},
         {{6935, 1584}, {11859, 14034}, {10360, 10699}}, {{1968, 3148}, {15284, 16151}, {15314, 13570}},
         {{3755, 3317}, {24677, 5814}, {2447, 16465}}, {{574, 102}, {4661, 23983}, {23875, 6349}},
         {{892, 543}, {2158, 665}, {15856, 4685}}, {{11326, 4767}, {1281, 16269}, {971, 3787}},
         {{13636, 5747}, {3000, 8310}, {2984, 826}}, {{6846, 16684}, {3167, 1306}, {18775, 12867}},
         {{3504, 3526}, {3124, 17959}, {3731, 95}}, {{8262, 6104}, {3689, 12009}, {3949, 4143}},
         {{21889, 5791}, {11776, 792}, {17136, 16}}, {{2298, 1282}, {577, 32103}, {5124, 7516}},
         {{8763, 4622}, {2326, 753}, {1359, 21680}}, {{3454, 2663}, {7270, 15997}, {8300, 4515}},
         {{3520, 24825}, {20689, 7797}, {6547, 25603}}, {{1581, 5814}, {2457, 2711}, {9095, 777}},
         {{2619, 8519}, {10141, 14173}, {9681, 4899}}, {{6091, 5326}, {7466, 9668}, {12259, 14427}},
         {{1568, 1288}, {597, 119}, {2542, 10738}}, {{5281, 5992}, {10972, 1640}, {26207, 1285}},
         {{4019, 16721}, {11031, 21500}, {4889, 27699}}, {{24430, 682}, {111, 1548}, {6365, 6315}}}};

template<typename T>
const std::array<std::tuple<std::pair<int32_t, int32_t>, std::pair<int32_t, int32_t>, std::pair<int32_t, int32_t>>, 100> FixedTripleGenerator<T>::TRIPLES_32 = {
        {{{784439641, 188320421}, {1686568666, 399480998}, {688446650, 370668614}},
         {{853493843, 431899253}, {173793078, 200597223}, {676749458, 16959510}},
         {{1254547970, 671720620}, {667835558, 955152407}, {426034364, 31375802}},
         {{1119644479, 503835829}, {832457616, 118397375}, {220622158, 1779301118}},
         {{1150980803, 867458650}, {125271345, 71025437}, {607840861, 375442553}},
         {{1346886242, 506901195}, {796047735, 528097398}, {964562918, 852608963}},
         {{1355496510, 603940088}, {202586683, 1177774905}, {703973015, 1015485409}},
         {{486070446, 134474903}, {875678089, 1057484432}, {146833702, 756374167}},
         {{534357214, 776097752}, {787087802, 549515188}, {114887556, 90534064}},
         {{9417552, 2109297727}, {566993406, 49517532}, {1420906434, 331397892}},
         {{650354126, 200807972}, {23955258, 515495908}, {684139283, 450675017}},
         {{758238296, 403309527}, {386128933, 38920972}, {360952619, 31274708}},
         {{137425705, 1124176934}, {1220968029, 759862137}, {359182060, 135244830}},
         {{312495133, 48604285}, {51115112, 16194797}, {659578870, 485539116}},
         {{8248942, 1020305073}, {240837363, 301727779}, {729211370, 446979008}},
         {{3498728, 293933374}, {652842415, 95058782}, {1105332854, 876896632}},
         {{1566160509, 452547159}, {452083470, 1200730324}, {1129838820, 665828932}},
         {{1635433, 1719307093}, {546277532, 712848556}, {247955985, 1458286943}},
         {{7683993, 130609217}, {130923468, 41666341}, {40303, 74443}},
         {{666601841, 588895255}, {73517521, 449322882}, {332804265, 1413474927}},
         {{477396721, 1407914933}, {1583348944, 66184611}, {970925391, 319571779}},
         {{1679105705, 82916377}, {461816294, 947872420}, {230052693, 199332159}},
         {{46041410, 130878290}, {1157673166, 132133953}, {982548891, 822449937}},
         {{371501, 259901280}, {472025277, 598204936}, {531086261, 1412418764}},
         {{769065662, 1149499828}, {1307770867, 116951380}, {166068646, 51708920}},
         {{298901898, 255052963}, {156170597, 477458188}, {1402039859, 28687274}},
         {{233503008, 685400327}, {115322395, 1360066216}, {1702813361, 103139588}},
         {{92193024, 1791224912}, {34436553, 29579156}, {644948151, 1200678233}},
         {{58327874, 40589553}, {28322872, 599353063}, {113874012, 332979921}},
         {{115857220, 301746690}, {174794049, 1122653914}, {392929806, 587188308}},
         {{992453219, 100567050}, {90712260, 1858023540}, {633653829, 971989651}},
         {{1402397500, 739462739}, {261929537, 36243008}, {221398175, 247919728}},
         {{442580736, 349454761}, {841503226, 943458274}, {1526813017, 213385443}},
         {{519103232, 544921018}, {11552426, 17889092}, {76614514, 450036602}},
         {{812249020, 508348944}, {727445158, 1099762618}, {591746055, 1133613177}},
         {{303613469, 510900795}, {1262112320, 816310800}, {579535040, 1528847040}},
         {{1133338445, 223760487}, {701613, 306555476}, {1499062878, 100505942}},
         {{189598431, 1028608446}, {7058403, 982247845}, {351410797, 1348887035}},
         {{1135529285, 77372749}, {249104221, 157944437}, {573518692, 1106766432}},
         {{604000199, 1143663645}, {1198760529, 444892617}, {710642498, 340011494}},
         {{437492949, 945270569}, {1775955523, 49355627}, {7134011, 9746793}},
         {{620024373, 1427460806}, {76803198, 88176592}, {463375762, 566346472}},
         {{174254360, 498944021}, {69701023, 1508654}, {57702820, 390631781}},
         {{247424234, 1549327858}, {193099328, 1821157141}, {1307586883, 194309577}},
         {{54961242, 4450884}, {934824156, 238626975}, {37967308, 855698974}},
         {{1603240295, 75406795}, {1205989388, 871449077}, {612161086, 1038028020}},
         {{729485999, 920269851}, {80706480, 24399048}, {1499042513, 550202335}},
         {{238311676, 1644138335}, {349308148, 409000908}, {801831264, 1127803616}},
         {{777569097, 199931314}, {15498923, 56173026}, {1206413450, 42277301}},
         {{668749358, 5812165}, {123597738, 962451555}, {56103345, 37189542}},
         {{1042072951, 623683065}, {1517410209, 561334059}, {890870903, 1175396553}},
         {{395953012, 381589222}, {318994115, 1265401935}, {517309915, 462662265}},
         {{929495404, 1208945980}, {316497776, 581675231}, {1513479318, 55800130}},
         {{620173833, 279460059}, {382111006, 152737547}, {1887260780, 68355608}},
         {{741423304, 410686405}, {608182728, 306577976}, {209473498, 1813349414}},
         {{705289077, 1218638560}, {1111066864, 11808660}, {988414172, 154041080}},
         {{101240651, 510987221}, {728593708, 93887987}, {64969552, 23170448}},
         {{1110942943, 736597192}, {1721567857, 120370583}, {257062050, 738433174}},
         {{653172526, 184869306}, {658843253, 12740374}, {55943943, 3744497}},
         {{232141851, 96646064}, {207626741, 1029246933}, {257808704, 274327534}},
         {{366444899, 947348224}, {1027703504, 841391218}, {1781767320, 151208430}},
         {{266582754, 745123633}, {937094972, 221932115}, {1588200541, 218355520}},
         {{317781936, 257739172}, {568150993, 1574889213}, {187845177, 1691463519}},
         {{85359257, 1901544499}, {607827619, 135122488}, {124844837, 405957983}},
         {{105515919, 469971702}, {519488657, 1512050807}, {208311048, 124914208}},
         {{64924447, 303504223}, {421359478, 1723208186}, {28403568, 246738352}},
         {{459851272, 838019438}, {53672610, 174797390}, {210032272, 262664208}},
         {{30326762, 114168583}, {579972041, 512706320}, {9502878, 451256235}},
         {{195752868, 320963192}, {126570013, 1496687377}, {84887731, 333335637}},
         {{1401047221, 149203881}, {310349321, 9628808}, {178261755, 79767107}},
         {{75045054, 100733506}, {102356486, 635545797}, {99262135, 320830025}},
         {{706021280, 915624571}, {299591290, 19974131}, {369522045, 203211266}},
         {{154702042, 761619389}, {168343705, 189195087}, {1787034238, 357702490}},
         {{495273527, 1250682137}, {76751677, 871105411}, {358304843, 10686389}},
         {{3142130, 848032979}, {56173967, 189424547}, {311841003, 436940431}},
         {{315432486, 718673100}, {26751157, 774578229}, {158052018, 167936642}},
         {{689112781, 1126106632}, {290115830, 176211887}, {195688020, 203278069}},
         {{1084390964, 465224089}, {111136112, 258965635}, {212978665, 117796014}},
         {{818454872, 541478823}, {1352813140, 456412914}, {418342912, 156820666}},
         {{454505818, 205500644}, {1213697650, 404065119}, {74592327, 1583470167}},
         {{208893817, 544872720}, {145642145, 85102041}, {457938724, 136522278}},
         {{1815491356, 30253943}, {549450111, 489071257}, {1145673837, 322011483}},
         {{306601729, 32460405}, {412927857, 473373822}, {607034293, 1124071285}},
         {{1553768985, 364921602}, {75130327, 414006197}, {997030331, 831704073}},
         {{122686532, 909329771}, {11615083, 163102335}, {26431026, 1236243140}},
         {{1210296844, 470027318}, {1403416282, 552991490}, {361520308, 1049449988}},
         {{80509976, 1147993196}, {440127596, 14716784}, {1243494923, 292442981}},
         {{244046895, 933780418}, {127893868, 104852942}, {15388692, 52059014}},
         {{478760450, 728139930}, {1321256839, 578199964}, {390147521, 353576339}},
         {{537099263, 145592803}, {659438115, 88530523}, {32236260, 185606744}},
         {{239238587, 1161570795}, {407214525, 836667802}, {278494913, 800402601}},
         {{638032362, 348979852}, {22336677, 4706170}, {372452989, 196041677}},
         {{316593262, 650390066}, {1563853104, 3099059}, {288380611, 1013035293}},
         {{692600918, 1048827795}, {49288106, 195594795}, {1719677373, 290560032}},
         {{268508172, 470118584}, {702165063, 213789244}, {623728212, 470391288}},
         {{1144416779, 803901215}, {4991806, 127770255}, {569025810, 760798096}},
         {{568572967, 622498361}, {1205589103, 141200967}, {393647105, 697689151}},
         {{1475882941, 297698725}, {442021071, 453225107}, {815776567, 232327757}},
         {{176286808, 298671532}, {1833847483, 274474645}, {1103634429, 827508035}},
         {{1153997320, 416802297}, {1405335237, 542583069}, {686200997, 1113933629}}}};

template<typename T>
const std::array<std::tuple<std::pair<int64_t, int64_t>, std::pair<int64_t, int64_t>, std::pair<int64_t, int64_t>>, 100> FixedTripleGenerator<T>::TRIPLES_64 = {
        {{{1419040523972253256, 6926112039458713057}, {986783605478428565, 5704469184537141156},
          {1104269693031738207, 7555163287616604354}},
         {{494262493506945468, 1123283698788612247}, {1737414994841120195, 1794155447467037552},
          {2728353612193711, 965261110060831194}},
         {{3561932274407166314, 1414196615792192691}, {2387315959427836, 64034666730414993},
          {1599622920451469089, 103442784120980696}},
         {{2179059469420353565, 818034343089108131}, {1794372655615701722, 1099799228498247930},
          {6367285749460884303, 974380884669100977}},
         {{4849106456555341385, 633361957465534717}, {2225760551427273954, 1458112450878356947},
          {37359372413233552, 4164503748405499630}},
         {{4733814588549792811, 4188864942522914142}, {2815749562796684396, 2701599978950446661},
          {888135116929072702, 2590215119454501755}},
         {{1540042373226671699, 1050240861240716111}, {3197998609785412151, 1373901768562019433},
          {2289836956418539132, 1354818735424213700}},
         {{714620152484866536, 1839797207210295718}, {535213924179085932, 220872000045148669},
          {718228121695850920, 6285912736927130518}},
         {{655449658843835312, 593576126713598513}, {5637800770869100989, 3445832310378331347},
          {1570126837294990368, 674420324895164528}},
         {{4679824421564618916, 1086749824551625467}, {4122809012643973983, 632495374992009380},
          {3440616095725323989, 1573002951885682696}},
         {{2298953445323179718, 2281448106379958993}, {450566195037446091, 5405395606780883782},
          {5040240245173203586, 3447508202271522181}},
         {{4713319705800203684, 2547337736260574}, {1700741328245237, 3260840904419075},
          {831742931649948518, 5700318196812954250}},
         {{1559780781980625336, 1403504550308994693}, {5594125285359156174, 464697849742710191},
          {2631232980755560089, 2255557974316063792}},
         {{64675032467319614, 8839588988099644}, {4917658269385664934, 3456718631140321667},
          {788254125787641958, 374552993502398500}},
         {{4121820086845286285, 1463528265216438371}, {3169782943716805988, 4238639457116914385},
          {2383313492033428, 3711784705508373788}},
         {{3165615861466802521, 1736173083433400301}, {28197055393759505, 69052859561088591},
          {4651088560731902842, 1344088547125555398}},
         {{7514615820856469067, 630923222703785658}, {5235960314442611480, 471120108244483440},
          {33209812762709701, 607492969542627}},
         {{722749804393237138, 676921961415437690}, {240274664285778735, 4479545792326830433},
          {2654337724282827117, 542987671932921171}},
         {{326230203968728736, 1640680668968376429}, {2845988947929413952, 4448700263512511034},
          {949521444222998193, 603121754062951553}},
         {{6421475199988766482, 1114750014840323489}, {2171189112578282901, 205345800338823310},
          {2776001886093543883, 5589192805480264878}},
         {{910826912142524345, 5714904300789355961}, {27651267190668167, 1978339544595722450},
          {3721746775142378860, 1034706967316176694}},
         {{4860043484026601341, 3754761809421143010}, {2495721583684120873, 1556332426057922027},
          {16268803711431627, 326710757976664225}},
         {{3064263843133996701, 3777957822796162197}, {1195690244582655095, 6542651019395627962},
          {263708692437068179, 889390923349086975}},
         {{264782350587356924, 5356441601460971245}, {4727134154005908346, 1954199260721410253},
          {4064075382244408584, 2924137174101179031}},
         {{666475670836416469, 3552722118651581244}, {10377550806369750, 173867619934720398},
          {818610363336111014, 103195764894369278}},
         {{2365150146985323879, 1052647011847958364}, {2773614170122614949, 4212893218493234167},
          {1120673493004316758, 134441888409875070}},
         {{714744139455520482, 4592468842997585537}, {261083475334044741, 150862218905455529},
          {153484176691627934, 7420960621975089004}},
         {{596614318851174340, 6077578144911316122}, {1363047438703022816, 957434890834566764},
          {1416612672331427245, 2597647078178462779}},
         {{18271625464538205, 532919992362283245}, {2058048671157478229, 487833346291477933},
          {901129284144189734, 137730605023904622}},
         {{2038924424772977727, 5450277347111127455}, {532231575913506169, 2051587666200148701},
          {1976133023337800719, 5925861972916536453}},
         {{2491403492918470599, 3241711764639542146}, {42711866635732248, 7259524845680630550},
          {3006204809702870123, 2685729107714263731}},
         {{753402478213548997, 557732849867224114}, {2501246230363836598, 2942815513728868063},
          {355527718932351129, 210070412430986026}},
         {{2604416024298372495, 2051802633953064000}, {1449908402838679935, 3775344855841027906},
          {3080620011478577668, 739416317464867595}},
         {{3379418945074720537, 1129235567468304337}, {722290089731088041, 948712450270860059},
          {3677318432448962106, 3981724405933127406}},
         {{168676709242839896, 18153594127838897}, {3261179619468895728, 4616845843243855666},
          {88257313854562733, 35035622095929477}},
         {{6520212483834831027, 1016476900512004244}, {2800352798991962349, 1284875973190911664},
          {626458319891671446, 4617123449842677749}},
         {{1967626571796979733, 605578820771758535}, {3073485353106965359, 295676753513435105},
          {3441675170814837915, 101761818469049381}},
         {{13173483494837419, 39958707208405377}, {211686502628895524, 69258089394578245},
          {2571083875008206684, 2997772754264072368}},
         {{920085686017585834, 134315507273521549}, {1936866917979499226, 478142735627048071},
          {282903043424464847, 931250457010305544}},
         {{2481181480244362734, 5080306300944182720}, {4906726007892180155, 1184327505312552071},
          {1995248390081409841, 29228547443383723}},
         {{325653138287641525, 141918634644105811}, {3843212853076363641, 977047074530681085},
          {2358254363101436369, 2875321749036756447}},
         {{1408051701010300316, 2979637634780204865}, {5433716300376054172, 2176398738327946015},
          {2059677916292656621, 1775450895412405122}},
         {{3881839838635067703, 3479852711597854977}, {945141555023492446, 2903715930092909232},
          {170722767374413510, 206512404099776586}},
         {{2872411713577101231, 2912354320310903019}, {22162342683842143, 20285114240066316},
          {1602939152285933571, 975706406641336923}},
         {{532533217018019345, 2201362656504875135}, {2189855591554335825, 975521572969123613},
          {48291026317657975, 422613547406637673}},
         {{270947098990778282, 132886851772892828}, {2589897067364817627, 5796061682545256038},
          {100934239523476, 1661911813780579122}},
         {{187086283578726234, 423690731072631344}, {169884317616048059, 2797235402970239352},
          {354831868473658262, 1401540393681392872}},
         {{3467162928731233140, 3976560024702481491}, {1373026667762160117, 5623125452395052199},
          {154656827599828962, 178946707246434146}},
         {{2945726415089199590, 2419574135100296147}, {1133485623763716142, 2183912579933288724},
          {407129160649066915, 1965805512898169103}},
         {{5996968593698684854, 1000786191663463590}, {3463839157905847005, 2933421660215936911},
          {17717366343599266, 3788449363236899374}},
         {{560671387668618170, 1120639152513711161}, {1150071379933567549, 7700698038091865830},
          {2556857366239501353, 4797049369071437072}},
         {{750633860573349739, 6656049846921177257}, {4115903487234219334, 146650569866928737},
          {666989708711478309, 4778961570836792551}},
         {{2741744674894396839, 2820265665308916385}, {490586380957827260, 3879944333744596981},
          {1006787716910328211, 623357961436233781}},
         {{1009878573708391436, 5023985062889150686}, {669372914392911563, 3973874029819574023},
          {4878327320282031218, 1996629676928976258}},
         {{1810036613706878782, 3982880553828505876}, {430278529499511700, 225680048405828346},
          {789562673409402900, 16467809460597096}},
         {{1365419467409643979, 6748063667791837740}, {90999079128082573, 8158333484307962533},
          {5936720136563773315, 2142992068883446715}},
         {{1880499724395422634, 7111550147314310188}, {6809565556984051390, 423752958790275888},
          {820992939779544124, 1360507702112324280}},
         {{123967186246604791, 2864072790471965178}, {4895881697403656567, 1609428359001006658},
          {123337798474928078, 7070561540662751835}},
         {{619639659266130720, 2402500296205901585}, {6763093455991557073, 2361618177772632014},
          {6708637120547935778, 836282242565159245}},
         {{2699450050645233446, 5791230839556555268}, {506757011136124034, 2195297113609064642},
          {2354774723625920029, 3278233641701309195}},
         {{3831182063788230625, 335663990863757599}, {1827627274335219666, 36702758824105602},
          {6002594132440062846, 1784703877131393154}},
         {{411080620081902748, 2664951256818190318}, {1794675834304792119, 335174690741975548},
          {4400029297080315387, 1310530058925056387}},
         {{2539597061302009866, 723230596354234556}, {5747446309894960852, 157206552468336138},
          {10762787545036342, 298641105128365438}},
         {{1191443835595533828, 24778610964698772}, {8425298135381196820, 418219420536671541},
          {112721690661665538, 437539521764691030}},
         {{1571782210602908595, 166670820184252547}, {1822192485127183221, 2404673567150781776},
          {3938456755503849996, 2327454190276424578}},
         {{5484573113390098202, 1857387021181072548}, {414747511231741025, 134763334931125326},
          {3027416502661282624, 392934956652256162}},
         {{2438336181685136653, 3023193273386245623}, {1807779014194579603, 706815910426284945},
          {701374200403652415, 1657116701460598097}},
         {{2229916569940676060, 3241022258639359633}, {3418609246768301478, 3229185044001736739},
          {1419795036870523548, 1203891380997349369}},
         {{676726074143999818, 2639990868336084506}, {1340886962415091874, 4877949816210151862},
          {31868330350112517, 702495169272370011}},
         {{574714373194450988, 1174263995061371932}, {509550616741291344, 4649101268210671452},
          {460130214982280660, 1291827827089078924}},
         {{7134988724025726454, 181773289611975676}, {2911793246118527786, 482563750688010249},
          {4394494107518465320, 2556073008726537230}},
         {{303608246788158471, 5336535148098056863}, {2305653942879250734, 6876010931813134271},
          {5447141688281971647, 512049661006961647}},
         {{143965535478191639, 9525002319758228}, {6023334201519217393, 1978869928155909134},
          {316970976524623558, 8465787246380422287}},
         {{5715475233193733674, 161893616410365694}, {2244399230480354679, 1693417182464362077},
          {2065684657036165564, 2358152197452667748}},
         {{1969667808160814886, 1014778447556461047}, {1065370574561635049, 890454237665968198},
          {493950221934338286, 2313701026459425381}},
         {{46720915015557577, 1008920896513750149}, {2452859289279512324, 3438181058207542443},
          {4443744884656530947, 3407245920765539151}},
         {{1518496243773655085, 6474435100481592389}, {1830352948403066838, 2154200444590094893},
          {5113635930052709760, 377747841686528982}},
         {{126592196171944248, 592507964528674629}, {1545030746463025325, 6679045067089654301},
          {3463586346401330318, 1322517960531988}},
         {{3136893974157385556, 5936579224244814814}, {2242573225221050180, 204293122743698127},
          {482518407702603750, 7135047042507143376}},
         {{425424383368189665, 1632125824741129426}, {6425416585648249281, 2687768884140743208},
          {434833539990953896, 1721904504774162243}},
         {{599289792603261385, 708753715246854149}, {367507817003420573, 4684129351897441607},
          {2611301553425263512, 1360623178861178848}},
         {{4396579483470895246, 2260011307629210151}, {1900305190008601009, 485290398278016557},
          {387249832961174460, 295473864395501626}},
         {{6170464341627120551, 1797306737956295034}, {2355719889321804115, 2124351158727902181},
          {1738066679406112100, 5187579865619044052}},
         {{2952419979996869796, 5181875744412857443}, {1991390227377367119, 4044663201236036807},
          {1144005023052473427, 3688519290577106247}},
         {{1053619022748946019, 1517158425553388552}, {5579258889216699298, 2599500272434812307},
          {4101557227668181120, 1594224576238889639}},
         {{4974518732185058305, 1664138643725955817}, {1819127339042233742, 787255705457518674},
          {1044082862761910028, 4159629357241532340}},
         {{208861986567136003, 824927617958735162}, {2959789731401963966, 913759450552203935},
          {3754119183942581800, 882418306983635969}},
         {{95441261764254233, 5102347794510439978}, {965326398629084842, 5999338370877472116},
          {5891760471557743658, 2335511476051122096}},
         {{4257276992219522141, 4952607184862506086}, {3666629878214724903, 3403318249533936530},
          {92002824644118100, 2172902540813088407}},
         {{680871201865897763, 882578944562877649}, {86947987238084024, 844339441403486148},
          {6411587141918548360, 1354702568447741096}},
         {{698710486749859805, 7721862656307652138}, {735447995188198937, 5827436073198427990},
          {442906426474969345, 2259252714269884168}},
         {{1199667766570917580, 2302823345917440088}, {280155451876549571, 6954348885546851529},
          {4203498747928837, 13332328946738859}},
         {{2234066269136526564, 2437643564272462988}, {637388358779768657, 6137777107566503044},
          {1102331013838511503, 3413876666259033249}},
         {{1492415837729311254, 434850866438544873}, {196852038125217491, 730906638814818019},
          {573401055617529100, 700745773660120382}},
         {{1838580741198121154, 68415794652267442}, {6936895529643272342, 1994695014241090179},
          {79366686974390348, 69399109858403080}},
         {{480421142158181941, 610775566505130147}, {549946011718518943, 25973494496748134},
          {34062385461384007, 440167551591919345}},
         {{3927319096571205330, 354409472707895821}, {2470983860326984460, 1970445223650219876},
          {1361892818939880048, 6587685247251168544}},
         {{4842500766449240349, 802090471373890379}, {710118495605127991, 1189326079140741257},
          {1958959019501865069, 730639838251875731}},
         {{366312885380231387, 3642725101559960156}, {2123311055450230499, 1025518561887226941},
          {7939990859216492528, 1195499836312247280}},
         {{189933203409373065, 684084332809546263}, {6974159489563448960, 1579455968049503328},
          {1127298602260943428, 4541858444970154428}}}};

template
class FixedTripleGenerator<bool>;

template
class FixedTripleGenerator<int8_t>;

template
class FixedTripleGenerator<int16_t>;

template
class FixedTripleGenerator<int32_t>;

template
class FixedTripleGenerator<int64_t>;